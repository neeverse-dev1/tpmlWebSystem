<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 9999">
  <div id="gridToast" class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body">
        그리드 설정이 저장되었습니다.
      </div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
  </div>
</div>


<div class="row g-3">
  <% gridList.forEach(grid => { %>
    <div class="col-6">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title"><%= grid.title || '제목 없음' %></h5>
          <p class="card-text">장비 ID: <%= grid.equipment_id || '-' %></p>

          <% if (grid.view_type === 'status') { %>
            <!-- 서버 상태 카드 -->
             <div class="row">

            <div class="col-6">
              <div class="card shadow-sm h-100">
                <div class="card-body">
                  <h5 class="card-title">서버 상태</h5>

                  <div class="mb-2">
                    <div class="d-flex justify-content-between">
                      <span>CPU 사용률</span>
                      <span id="cpuValue" class="fw-bold text-danger">0%</span>
                    </div>
                    <div class="progress" style="height: 6px;">
                      <div id="cpuBar" class="progress-bar bg-danger" style="width: 0%"></div>
                    </div>
                  </div>

                  <div class="mb-2">
                    <div class="d-flex justify-content-between">
                      <span>RAM</span>
                      <span id="ramValue" class="fw-bold text-primary">0GB</span>
                    </div>
                    <div class="progress" style="height: 6px;">
                      <div id="ramBar" class="progress-bar bg-primary" style="width: 0%"></div>
                    </div>
                  </div>

                  <div class="mb-2">
                    <div class="d-flex justify-content-between">
                      <span>디스크</span>
                      <span id="diskValue" class="fw-bold text-success">0 GB</span>
                    </div>
                    <div class="progress" style="height: 6px;">
                      <div id="diskBar" class="progress-bar bg-success" style="width: 0%"></div>
                    </div>
                  </div>

                  <div class="mt-2 text-muted small">
                    네트워크 : <span id="netValue"></span>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-6">
              <div class="card shadow-sm h-100">
                <div class="card-body">
                  <h5 class="card-title">서버 정보</h5>

                  <table class="table table-sm mb-0">
                    <tbody>
                      <tr>
                        <th scope="row">내부 IP</th>
                        <td id="localIp">0.0.0.0</td>
                      </tr>
                      <tr>
                        <th scope="row">Node Version</th>
                        <td id="nodeVersion">v0.0.0</td>
                      </tr>
                      <tr>
                        <th scope="row">Uptime</th>
                        <td id="uptime">0</td>
                      </tr>
                      <tr>
                        <th scope="row">서버 시작</th>
                        <td id="startedAt">0000-00-00 00:00:00</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <% } else if (grid.view_type === 'equipment') { %>
            <!-- 장비 카드 -->
            <div class="mb-3">
              <div id="map-<%= grid.id %>" style="height: 150px; border-radius: 6px;"></div>
            </div>
            <div class="d-flex justify-content-between align-items-center mb-2">
  <div class="text-center">
    <canvas id="tempChart-<%= grid.id %>" width="100" height="80"></canvas>
    <div class="fw-bold text-danger">온도: <span id="tempValue-<%= grid.id %>">--</span>°C</div>
  </div>
  <div class="text-center">
    <canvas id="humidChart-<%= grid.id %>" width="100" height="80"></canvas>
    <div class="fw-bold text-primary">습도: <span id="humidValue-<%= grid.id %>">--</span>%</div>
  </div>
  <div class="text-center">
    <canvas id="pressChart-<%= grid.id %>" width="100" height="80"></canvas>
    <div class="fw-bold text-success">압력: <span id="pressValue-<%= grid.id %>">--</span>hPa</div>
  </div>
</div>


          <% } else { %>
            <p class="text-muted">알 수 없는 view_type: <%= grid.view_type %></p>
          <% } %>
        </div>
      </div>
    </div>
  <% }) %>
</div>

<script>
  window.gridList = <%- JSON.stringify(gridList || []) %>;
</script>
